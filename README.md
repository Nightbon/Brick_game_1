# 🎮 BrickGame Tetris

<div align="center">
  
  <img src="misc/images/tetris-game.png" alt="Tetris Game" width="400"/>
  
  **Реализация классической игры «Тетрис» для терминала в стиле портативной консоли BrickGame**
  
  [![C](https://img.shields.io/badge/language-C-blue.svg)](https://en.wikipedia.org/wiki/C_(programming_language))
  [![ncurses](https://img.shields.io/badge/library-ncurses-green.svg)](https://invisible-island.net/ncurses/)
  [![Check](https://img.shields.io/badge/testing-Check-orange.svg)](https://libcheck.github.io/check/)
  [![Coverage](https://img.shields.io/badge/coverage-100%25-brightgreen.svg)](https://gcc.gnu.org/onlinedocs/gcc/Gcov.html)
  
</div>

---

## 📋 Содержание

- [Обзор](#-обзор)
- [Особенности](#-особенности)
- [Требования](#-требования)
- [Сборка и установка](#-сборка-и-установка)
- [Управление](#-управление)
- [Архитектура](#-архитектура)
- [Тестирование](#-тестирование)
- [Документация](#-документация)
- [Дистрибутив](#-дистрибутив)
- [Автор](#-автор)

---

## 🎯 Обзор

Проект представляет собой полноценную реализацию игры **«Тетрис»** на языке C с четким разделением архитектуры:

| Компонент | Назначение | Технологии |
|-----------|-----------|------------|
| **Библиотека логики** | Игровая механика, конечный автомат | C11, Check |
| **Терминальный интерфейс** | Отрисовка, ввод пользователя | ncurses |

> 🏆 **Ключевая особенность**: Полное разделение логики и представления. Библиотека не зависит от способа отображения!

---

## ✨ Особенности

### 🎲 Игровая механика

<div align="center">

| Фигура | I | J | L | O | S | T | Z |
|--------|---|---|---|---|---|---|---|
| Вращение | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| Падение | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| Сдвиг | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |

</div>

- ✅ **7 классических фигур** тетрамино — все варианты из оригинальной игры
- ✅ **Вращение фигур** — интуитивное управление клавишей ↑
- ✅ **Перемещение по горизонтали** — плавное движение ← →
- ✅ **Ускоренное падение** — мгновенный сброс фигуры (↓)
- ✅ **Следующая фигура** — предпросмотр на боковой панели
- ✅ **Уничтожение линий** — анимация удаления заполненных рядов
- ✅ **Game Over** — завершение при достижении верхней границы

### 📊 Система прогрессии

| Линии | Очки | Уровень | Требование | Скорость |
|-------|------|---------|------------|----------|
| 1 | 100 | 1 | 0-599 очков | 400 мс |
| 2 | 300 | 2 | 600-1199 | 380 мс |
| 3 | 700 | 3 | 1200-1799 | 360 мс |
| 4 | 1500 | ... | ... | ... |
|      |      | 10 | 5400+ | 200 мс |

- ✅ **Рекорды** — сохранение лучшего результата в `highscore.dat`
- ✅ **Уровни** — динамическое повышение сложности (1-10)
- ✅ **Скорость** — прогрессивное ускорение с каждым уровнем

### 🖥️ Интерфейс
┌──────────────────────┐┌──────────────────┐
│ [][][] ││ HI-Score: 1500 │
│ [] ││ Score: 1200 │
│ ││ Level: 3 │
│ [][] ││ Speed: 4 │
│ [][] ││ │
│ ││ Next: │
│ [][][][] ││ [][] │
│ ││ [][] │
│ ││ │
│ [] ││ Controls: │
│ [] ││ ← → - Move │
│ [][] ││ ↑ - Rotate │
│ ││ ↓ - Fast drop │
└──────────────────────┘└──────────────────┘

text

- ✅ **Игровое поле** — точно 10×20 клеток
- ✅ **Информационная панель** — рекорд, счет, уровень, скорость
- ✅ **Предпросмотр** — отображение следующей фигуры
- ✅ **Состояния игры** — пауза, старт, game over
- ✅ **Адаптивная отрисовка** — оптимальная производительность

---

## 🔧 Требования

### Системные требования

| ОС | Поддержка | Примечание |
|----|-----------|------------|
| Linux | ✅ Полная | Рекомендуемая платформа |
| macOS | ✅ Полная | Требуется Homebrew |
| Windows | ⚠️ Ограниченная | Через WSL2 |

### Установка зависимостей

<details>
<summary><b>🐧 Ubuntu / Debian</b></summary>

```bash
sudo apt update
sudo apt install gcc make libncurses-dev libcheck-dev lcov
</details><details> <summary><b>🍎 macOS</b></summary>
bash
# Установка Homebrew (если не установлен)
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# Установка зависимостей
brew install ncurses check lcov
</details>
🚀 Сборка и установка
Быстрый старт
bash
# Клонирование репозитория
git clone <repository-url>
cd C7_BrickGame_v1.0/src

# Сборка проекта
make all

# Запуск игры
./brickgame
Команды Makefile
Команда	Описание	Пример использования
make all	Полная сборка игры	make all
make install	Установка в ./build/	make install DESTDIR=~/games
make uninstall	Удаление из ./build/	make uninstall
make clean	Очистка артефактов	make clean
make test	Запуск unit-тестов	make test
make gcov_report	Отчет о покрытии	make gcov_report
make dist	Создание дистрибутива	make dist
make dvi	Генерация документации	make dvi
make valgrind	Проверка утечек памяти	make valgrind
make cppcheck	Статический анализ	make cppcheck
Примеры сборки
bash
# Разработка с отладочной информацией
make CFLAGS="-g -O0"

# Релизная сборка с оптимизацией
make CFLAGS="-O3"

# Сборка с покрытием кода
make gcov_report
🎮 Управление
<div align="center">
Клавиша	Действие	Описание
s	Старт	Начало новой игры
← →	Движение	Перемещение фигуры влево/вправо
↑	Поворот	Вращение фигуры на 90°
↓	Ускорение	Мгновенное падение вниз
p	Пауза	Приостановка/возобновление игры
q	Выход	Завершение программы
</div>
🏗 Архитектура
Структура проекта
text
📦 C7_BrickGame_v1.0
├── 📂 src
│   ├── 📂 brick_game
│   │   └── 📂 tetris           # Библиотека логики
│   │       ├── 📄 tetris_lib.h     # Публичный интерфейс
│   │       ├── 📄 tetris_lib.c     # Реализация логики
│   │       ├── 📄 libtetris.a      # Статическая библиотека
│   │       └── 📄 test.c           # Unit-тесты
│   └── 📂 gui
│       └── 📂 cli              # Терминальный интерфейс
│           ├── 📄 tetris_cli.h     # Заголовочный файл GUI
│           └── 📄 tetris_cli.c     # Отрисовка и ввод
├── 📂 materials                # Дополнительные материалы
├── 📂 misc                    # Изображения и схемы
└── 📄 Makefile                # Система сборки
Конечный автомат
<div align="center">
text
┌─────────────┐     Start     ┌─────────────┐     spawn()     ┌─────────────┐
│ Start_init  │ ────────────> │    Spawn    │ ─────────────> │  Move_fig   │
└─────────────┘               └─────────────┘                └─────────────┘
      ↑                                                             │
      │                            ┌────────────────────────────────┘
      │                            │         check_y()
      │                            ▼
┌─────────────┐     Start     ┌─────────────┐
│ Game_over   │ <──────────── │ Calc_score  │
└─────────────┘   fig.y < 0   └─────────────┘
                                      │
                                      │ fig.y >= 0
                                      ▼
                                ┌─────────────┐
                                │    Spawn    │
                                └─────────────┘
</div>
Состояние	Описание	Действия
Start_init	Ожидание старта	Загрузка рекорда
Spawn	Появление фигуры	Генерация следующей
Move_fig	Активная игра	Обработка ввода, падение
Calc_score	Подсчет очков	Удаление линий, повышение уровня
Game_over	Завершение игры	Сохранение рекорда
Диаграмма конечного автомата
Для генерации диаграммы используйте Graphviz:

bash
dot -Tpng misc/images/fsm.dot -o misc/images/tetris-fsm.png
🧪 Тестирование
Unit-тестирование
Фреймворк: libcheck

Покрытие строк: 100%

Покрытие ветвлений: 100%

bash
# Запуск тестов
make test

# Пример вывода:
# Running suite: Tetris Library Tests
#   100%: Checks: 5, Failures: 0, Errors: 0
Покрытие кода
bash
# Генерация отчета
make gcov_report

# Открыть отчет
firefox coverage_report/index.html
# или
open coverage_report/index.html  # macOS
<div align="center"> <img src="misc/images/coverage-example.png" alt="Coverage Report" width="600"/> </div>
Проверка памяти
bash
# Запуск с Valgrind
make valgrind

# Пример вывода:
# All heap blocks were freed -- no leaks are possible
📖 Документация
Генерация документации
bash
# Автоматическая генерация
make dvi

# Документация доступна в:
open build/docs/index.html
Формат документации
✅ Doxygen-совместимые комментарии

✅ Полное описание API

✅ Диаграммы зависимостей

✅ Примеры использования

c
/**
 * @brief Проверяет, можно ли разместить фигуру в текущей позиции.
 * @param val Состояние игры.
 * @return 1 - позиция валидна, 0 - столкновение или выход за границы.
 * 
 * @note Функция не изменяет состояние игры, только проверяет.
 */
int check(Game_intro val);
📦 Дистрибутив
Создание дистрибутива
bash
# Создание архива с исходным кодом
make dist

# Результат:
# 📦 brickgame_tetris-1.0.tar.gz
Состав дистрибутива
text
brickgame_tetris-1.0.tar.gz
├── src/              # Исходный код
├── Makefile          # Система сборки
├── README.md         # Документация
├── materials/        # Учебные материалы
└── misc/             # Изображения и схемы
👨‍💻 Автор
Проект разработан в рамках образовательной программы "BrickGame v1.0".

<div align="center">
Выполнил: Студент школы 21

Год: 2024

⭐ Приятной игры! ⭐

"Тетрис — это не просто игра, это философия порядка"

</div>